const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/mermaid.core.BrI5alCD.js","_astro/index.BVCr90Bx.js"])))=>i.map(i=>d[i]);
import{j as e}from"./jsx-runtime.Cb1L4DVx.js";import{r as o}from"./index.BVCr90Bx.js";const A="modulepreload",N=function(h){return"/sparrow-ai-tech/"+h},S={},C=function(m,g,f){let w=Promise.resolve();if(g&&g.length>0){let i=function(r){return Promise.all(r.map(s=>Promise.resolve(s).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),y=n?.nonce||n?.getAttribute("nonce");w=i(g.map(r=>{if(r=N(r),r in S)return;S[r]=!0;const s=r.endsWith(".css"),d=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${d}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":A,s||(c.as="script"),c.crossOrigin="",c.href=r,y&&c.setAttribute("nonce",y),document.head.appendChild(c),s)return new Promise((E,v)=>{c.addEventListener("load",E),c.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${r}`)))})}))}function l(i){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=i,window.dispatchEvent(n),!n.defaultPrevented)throw i}return w.then(i=>{for(const n of i||[])n.status==="rejected"&&l(n.reason);return m().catch(l)})};function M({onPickMermaid:h}){const[m,g]=o.useState("sparesparrow/sparrow-ai-tech"),[f,w]=o.useState("readme"),[l,i]=o.useState(""),[n,y]=o.useState([]),[r,s]=o.useState(""),[d,c]=o.useState(!1),[E,v]=o.useState(""),b=o.useMemo(()=>{if(!l)return[];const t=[],u=/```\s*mermaid\s+([\s\S]*?)```/gi;let a;for(;(a=u.exec(l))!==null;)t.push(a[1].trim());return t},[l]);o.useEffect(()=>{let t=!1;async function u(){v(""),c(!0);try{if(f==="readme"){const a=`https://raw.githubusercontent.com/${m}/HEAD/README.md`,p=await fetch(a);if(!p.ok)throw new Error(`Failed to load README: ${p.status}`);const x=await p.text();t||i(x)}else{const a=await fetch(`https://api.github.com/repos/${m}/actions/workflows`);if(!a.ok)throw new Error(`Failed to list workflows: ${a.status}`);const p=await a.json();t||y(p.workflows||[]),i("")}}catch(a){t||v(a.message||String(a))}finally{t||c(!1)}}return u(),()=>{t=!0}},[m,f]);async function k(t){c(!0),v("");try{const u=n.find(x=>x.id===Number(t));if(!u)return;const a=await fetch(u.url,{headers:{Accept:"application/vnd.github+json"}});if(!a.ok)throw new Error(`Failed to load workflow: ${a.status}`);const p=await a.json();if(p.path){const x=`https://raw.githubusercontent.com/${m}/HEAD/${p.path}`,j=await fetch(x);if(!j.ok)throw new Error(`Failed to load raw workflow: ${j.status}`);const R=await j.text();i(R)}}catch(u){v(u.message||String(u))}finally{c(!1)}}return e.jsxs("section",{className:"cyber-card",style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("input",{value:m,onChange:t=>g(t.target.value),placeholder:"owner/name",className:"form-control",style:{maxWidth:320}}),e.jsxs("select",{value:f,onChange:t=>w(t.target.value),className:"form-control",style:{maxWidth:160},children:[e.jsx("option",{value:"readme",children:"README.md"}),e.jsx("option",{value:"actions",children:"GitHub Actions"})]}),f==="actions"&&n.length>0&&e.jsxs("select",{value:r,onChange:t=>{s(t.target.value),k(t.target.value)},className:"form-control",style:{maxWidth:260},children:[e.jsx("option",{value:"",children:"Select workflow"}),n.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.state,")"]},t.id))]})]}),d&&e.jsx("div",{style:{marginTop:12},children:"Loadingâ€¦"}),E&&e.jsxs("div",{style:{marginTop:12,color:"var(--color-cyber-orange)"},children:["Error: ",E]}),f==="readme"&&l&&e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{style:{marginBottom:8,color:"var(--color-cyber-text-dim)"},children:["Found ",b.length," mermaid block(s) in README"]}),e.jsx("div",{style:{display:"grid",gap:12},children:b.map((t,u)=>e.jsxs("div",{className:"cyber-card",children:[e.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:t}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:8},children:e.jsx("button",{className:"cyber-btn cyber-btn-primary",onClick:()=>h?.(t),children:"Use in editor"})})]},u))})]}),f==="actions"&&l&&e.jsx("div",{style:{marginTop:12},children:e.jsx("pre",{style:{maxHeight:300,overflow:"auto"},children:l})})]})}const T=`graph TD
  A[Start] --> B[Choice];
  B -->|Yes| C[Happy];
  B -->|No| D[Sad];`;function _(){const[h,m]=o.useState(T),[g,f]=o.useState(""),[w,l]=o.useState(""),i=o.useRef(null),n=o.useRef(0);o.useEffect(()=>{let r=!0;return C(async()=>{const{default:s}=await import("./mermaid.core.BrI5alCD.js").then(d=>d.bB);return{default:s}},__vite__mapDeps([0,1])).then(({default:s})=>{r&&(s.initialize({startOnLoad:!1}),i.current=s,y(h))}),()=>{r=!1}},[]),o.useEffect(()=>{const r=setTimeout(()=>y(h),400);return()=>clearTimeout(r)},[h]);async function y(r){if(!(!r.trim()||!i.current))try{const s=`m-${++n.current}`,{svg:d}=await i.current.render(s,r);f(d),l("")}catch(s){l(s.message),f("")}}return e.jsxs("section",{className:"cyber-container",style:{display:"grid",gap:24},children:[e.jsx(M,{onPickMermaid:r=>m(r)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[e.jsx("textarea",{value:h,onChange:r=>m(r.target.value),className:"form-control",style:{minHeight:300,fontFamily:"monospace"}}),e.jsx("div",{className:"cyber-card",dangerouslySetInnerHTML:{__html:g}})]}),w&&e.jsx("pre",{style:{color:"var(--color-cyber-orange)"},children:w})]})}export{_ as M,C as _};
